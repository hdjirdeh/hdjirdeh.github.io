<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Progressive Web Apps with Angular: Part 2 - Lazy Loading</title>
  <meta name="description" content="Lazy loading with Angular">

  <!-- Schema.org markup for Google+ -->
  
  <meta itemprop="name" content="Progressive Web Apps with Angular: Part 2 - Lazy Loading">  
  <meta itemprop="description" content="Lazy loading with Angular">  
  <meta itemprop="image" content="https://houssein.me/assets/progressive-angular-applications-2/banner.png"> 

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@hdjirdeh">
  <meta name="twitter:creator" content="@hdjirdeh"> 
  <meta name="twitter:title" content="Progressive Web Apps with Angular: Part 2 - Lazy Loading">  
  <meta name="twitter:url" content="https://houssein.me/progressive-angular-applications-2">  
  <meta name="twitter:description" content="Lazy loading with Angular">  
  <meta name="twitter:image" content="https://houssein.me/assets/progressive-angular-applications-2/banner.png"> 

  <!-- Open Graph data -->
  
  <meta property="og:title" content="Progressive Web Apps with Angular: Part 2 - Lazy Loading"> 
  <meta property="og:type" content="article" /> 
  <meta property="og:url" content="https://houssein.me/progressive-angular-applications-2">  
  <meta property="og:image" content="https://houssein.me/assets/progressive-angular-applications-2/banner.png">  
  <meta property="og:description" content="Lazy loading with Angular">  
  <meta property="article:published_time" content="2018-12-05 07:30:00 +0000" />
  <meta property="article:modified_time" content="2018-12-05 07:30:00 +0000" /> 
  <meta property="fb:admins" content="1518546144" />
  
  <!-- Icons -->
  <meta name="msapplication-TileColor" content="#b91d47">
	<meta name="msapplication-TileImage" content="/icons/mstile-150x150.png">
  <meta name="msapplication-config" content="/icons/browserconfig.xml">

	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="default">

  <link rel="manifest" href="/icons/site.webmanifest">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#d0113f">

  <link rel="shortcut icon" type="image/x-icon" href="/icons/favicon.ico" />
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">

  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png">

  <meta name="theme-color" content="#ffffff">

  <link rel="canonical" href="https://houssein.me/progressive-angular-applications-2">
  <link rel="author" href="https://plus.google.com/109730836902589271473" />
  <link rel="alternate" type="application/rss+xml" title="Houssein Djirdeh" href="https://houssein.me/feed.xml">  
  <style>
    /*! TACHYONS v4.9.1 | http://tachyons.io  (SELECTED STYLES) */
    .dim:active,.dim:focus,.dim:hover{-webkit-backface-visibility:hidden}.f-6,.f-headline{font-size:6rem}.f-5,.f-subheadline{font-size:5rem}.f1{font-size:3rem}.f2{font-size:2.25rem}.f3{font-size:1.5rem}.f4{font-size:1.25rem}.f5{font-size:1rem}.f6{font-size:.875rem}.f7{font-size:.75rem}.br0{border-radius:0}.br1{border-radius:.125rem}.br2{border-radius:.25rem}.br3{border-radius:.5rem}.br4{border-radius:1rem}@media screen and (min-width:30em){.f1-ns{font-size:3rem}.f2-ns{font-size:2.25rem}.f3-ns{font-size:1.5rem}.f4-ns{font-size:1.25rem}.f5-ns{font-size:1rem}.f6-ns{font-size:.875rem}.f7-ns{font-size:.75rem}.fw1-ns{font-weight:100}.fw2-ns{font-weight:200}.fw3-ns{font-weight:300}.fw4-ns{font-weight:400}.fw5-ns{font-weight:500}.fw6-ns{font-weight:600}.fw7-ns{font-weight:700}.fw8-ns{font-weight:800}.fw9-ns{font-weight:900}.pa0-ns{padding:0}.pa1-ns{padding:.25rem}.pa2-ns{padding:.5rem}.pa3-ns{padding:1rem}.pa4-ns{padding:2rem}.pa5-ns{padding:4rem}.pa6-ns{padding:8rem}.pa7-ns{padding:16rem}.pl0-ns{padding-left:0}.pl1-ns{padding-left:.25rem}.pl2-ns{padding-left:.5rem}.pl3-ns{padding-left:1rem}.pl4-ns{padding-left:2rem}.pl5-ns{padding-left:4rem}.pl6-ns{padding-left:8rem}.pl7-ns{padding-left:16rem}.pr0-ns{padding-right:0}.pr1-ns{padding-right:.25rem}.pr2-ns{padding-right:.5rem}.pr3-ns{padding-right:1rem}.pr4-ns{padding-right:2rem}.pr5-ns{padding-right:4rem}.pr6-ns{padding-right:8rem}.pr7-ns{padding-right:16rem}.pb0-ns{padding-bottom:0}.pb1-ns{padding-bottom:.25rem}.pb2-ns{padding-bottom:.5rem}.pb3-ns{padding-bottom:1rem}.pb4-ns{padding-bottom:2rem}.pb5-ns{padding-bottom:4rem}.pb6-ns{padding-bottom:8rem}.pb7-ns{padding-bottom:16rem}.pt0-ns{padding-top:0}.pt1-ns{padding-top:.25rem}.pt2-ns{padding-top:.5rem}.pt3-ns{padding-top:1rem}.pt4-ns{padding-top:2rem}.pt5-ns{padding-top:4rem}.pt6-ns{padding-top:8rem}.pt7-ns{padding-top:16rem}.pv0-ns{padding-top:0;padding-bottom:0}.pv1-ns{padding-top:.25rem;padding-bottom:.25rem}.pv2-ns{padding-top:.5rem;padding-bottom:.5rem}.pv3-ns{padding-top:1rem;padding-bottom:1rem}.pv4-ns{padding-top:2rem;padding-bottom:2rem}.pv5-ns{padding-top:4rem;padding-bottom:4rem}.pv6-ns{padding-top:8rem;padding-bottom:8rem}.pv7-ns{padding-top:16rem;padding-bottom:16rem}.ph0-ns{padding-left:0;padding-right:0}.ph1-ns{padding-left:.25rem;padding-right:.25rem}.ph2-ns{padding-left:.5rem;padding-right:.5rem}.ph3-ns{padding-left:1rem;padding-right:1rem}.ph4-ns{padding-left:2rem;padding-right:2rem}.ph5-ns{padding-left:4rem;padding-right:4rem}.ph6-ns{padding-left:8rem;padding-right:8rem}.ph7-ns{padding-left:16rem;padding-right:16rem}.ma0-ns{margin:0}.ma1-ns{margin:.25rem}.ma2-ns{margin:.5rem}.ma3-ns{margin:1rem}.ma4-ns{margin:2rem}.ma5-ns{margin:4rem}.ma6-ns{margin:8rem}.ma7-ns{margin:16rem}.ml0-ns{margin-left:0}.ml1-ns{margin-left:.25rem}.ml2-ns{margin-left:.5rem}.ml3-ns{margin-left:1rem}.ml4-ns{margin-left:2rem}.ml5-ns{margin-left:4rem}.ml6-ns{margin-left:8rem}.ml7-ns{margin-left:16rem}.mr0-ns{margin-right:0}.mr1-ns{margin-right:.25rem}.mr2-ns{margin-right:.5rem}.mr3-ns{margin-right:1rem}.mr4-ns{margin-right:2rem}.mr5-ns{margin-right:4rem}.mr6-ns{margin-right:8rem}.mr7-ns{margin-right:16rem}.mb0-ns{margin-bottom:0}.mb1-ns{margin-bottom:.25rem}.mb2-ns{margin-bottom:.5rem}.mb3-ns{margin-bottom:1rem}.mb4-ns{margin-bottom:2rem}.mb5-ns{margin-bottom:4rem}.mb6-ns{margin-bottom:8rem}.mb7-ns{margin-bottom:16rem}.mt0-ns{margin-top:0}.mt1-ns{margin-top:.25rem}.mt2-ns{margin-top:.5rem}.mt3-ns{margin-top:1rem}.mt4-ns{margin-top:2rem}.mt5-ns{margin-top:4rem}.mt6-ns{margin-top:8rem}.mt7-ns{margin-top:16rem}.mv0-ns{margin-top:0;margin-bottom:0}.mv1-ns{margin-top:.25rem;margin-bottom:.25rem}.mv2-ns{margin-top:.5rem;margin-bottom:.5rem}.mv3-ns{margin-top:1rem;margin-bottom:1rem}.mv4-ns{margin-top:2rem;margin-bottom:2rem}.mv5-ns{margin-top:4rem;margin-bottom:4rem}.mv6-ns{margin-top:8rem;margin-bottom:8rem}.mv7-ns{margin-top:16rem;margin-bottom:16rem}.mh0-ns{margin-left:0;margin-right:0}.mh1-ns{margin-left:.25rem;margin-right:.25rem}.mh2-ns{margin-left:.5rem;margin-right:.5rem}.mh3-ns{margin-left:1rem;margin-right:1rem}.mh4-ns{margin-left:2rem;margin-right:2rem}.mh5-ns{margin-left:4rem;margin-right:4rem}.mh6-ns{margin-left:8rem;margin-right:8rem}.mh7-ns{margin-left:16rem;margin-right:16rem}.mw1-ns{max-width:1rem}.mw2-ns{max-width:2rem}.mw3-ns{max-width:4rem}.mw4-ns{max-width:8rem}.mw5-ns{max-width:16rem}.mw6-ns{max-width:32rem}.mw7-ns{max-width:48rem}.mw8-ns{max-width:64rem}.mw9-ns{max-width:96rem}}.normal{font-weight:400}.b{font-weight:700}.fw1{font-weight:100}.fw2{font-weight:200}.fw3{font-weight:300}.fw4{font-weight:400}.fw5{font-weight:500}.fw6{font-weight:600}.fw7{font-weight:700}.fw8{font-weight:800}.fw9{font-weight:900}.near-black{color:#111}.white{color:#fff}.ttl{text-transform:lowercase}.flex{display:-webkit-box;display:-ms-flexbox;display:flex}.flex-column{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.items-start{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.items-end{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.items-center{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.justify-center{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.justify-between{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.pa0{padding:0}.pa1{padding:.25rem}.pa2{padding:.5rem}.pa3{padding:1rem}.pa4{padding:2rem}.pa5{padding:4rem}.pa6{padding:8rem}.pa7{padding:16rem}.pl0{padding-left:0}.pl1{padding-left:.25rem}.pl2{padding-left:.5rem}.pl3{padding-left:1rem}.pl4{padding-left:2rem}.pl5{padding-left:4rem}.pl6{padding-left:8rem}.pl7{padding-left:16rem}.pr0{padding-right:0}.pr1{padding-right:.25rem}.pr2{padding-right:.5rem}.pr3{padding-right:1rem}.pr4{padding-right:2rem}.pr5{padding-right:4rem}.pr6{padding-right:8rem}.pr7{padding-right:16rem}.pb0{padding-bottom:0}.pb1{padding-bottom:.25rem}.pb2{padding-bottom:.5rem}.pb3{padding-bottom:1rem}.pb4{padding-bottom:2rem}.pb5{padding-bottom:4rem}.pb6{padding-bottom:8rem}.pb7{padding-bottom:16rem}.pt0{padding-top:0}.pt1{padding-top:.25rem}.pt2{padding-top:.5rem}.pt3{padding-top:1rem}.pt4{padding-top:2rem}.pt5{padding-top:4rem}.pt6{padding-top:8rem}.pt7{padding-top:16rem}.pv0{padding-top:0;padding-bottom:0}.pv1{padding-top:.25rem;padding-bottom:.25rem}.pv2{padding-top:.5rem;padding-bottom:.5rem}.pv3{padding-top:1rem;padding-bottom:1rem}.pv4{padding-top:2rem;padding-bottom:2rem}.pv5{padding-top:4rem;padding-bottom:4rem}.pv6{padding-top:8rem;padding-bottom:8rem}.pv7{padding-top:16rem;padding-bottom:16rem}.ph0{padding-left:0;padding-right:0}.ph1{padding-left:.25rem;padding-right:.25rem}.ph2{padding-left:.5rem;padding-right:.5rem}.ph3{padding-left:1rem;padding-right:1rem}.ph4{padding-left:2rem;padding-right:2rem}.ph5{padding-left:4rem;padding-right:4rem}.ph6{padding-left:8rem;padding-right:8rem}.ph7{padding-left:16rem;padding-right:16rem}.ma0{margin:0}.ma1{margin:.25rem}.ma2{margin:.5rem}.ma3{margin:1rem}.ma4{margin:2rem}.ma5{margin:4rem}.ma6{margin:8rem}.ma7{margin:16rem}.ml0{margin-left:0}.ml1{margin-left:.25rem}.ml2{margin-left:.5rem}.ml3{margin-left:1rem}.ml4{margin-left:2rem}.ml5{margin-left:4rem}.ml6{margin-left:8rem}.ml7{margin-left:16rem}.mr0{margin-right:0}.mr1{margin-right:.25rem}.mr2{margin-right:.5rem}.mr3{margin-right:1rem}.mr4{margin-right:2rem}.mr5{margin-right:4rem}.mr6{margin-right:8rem}.mr7{margin-right:16rem}.mb0{margin-bottom:0}.mb1{margin-bottom:.25rem}.mb2{margin-bottom:.5rem}.mb3{margin-bottom:1rem}.mb4{margin-bottom:2rem}.mb5{margin-bottom:4rem}.mb6{margin-bottom:8rem}.mb7{margin-bottom:16rem}.mt0{margin-top:0}.mt1{margin-top:.25rem}.mt2{margin-top:.5rem}.mt3{margin-top:1rem}.mt4{margin-top:2rem}.mt5{margin-top:4rem}.mt6{margin-top:8rem}.mt7{margin-top:16rem}.mv0{margin-top:0;margin-bottom:0}.mv1{margin-top:.25rem;margin-bottom:.25rem}.mv2{margin-top:.5rem;margin-bottom:.5rem}.mv3{margin-top:1rem;margin-bottom:1rem}.mv4{margin-top:2rem;margin-bottom:2rem}.mv5{margin-top:4rem;margin-bottom:4rem}.mv6{margin-top:8rem;margin-bottom:8rem}.mv7{margin-top:16rem;margin-bottom:16rem}.mh0{margin-left:0;margin-right:0}.mh1{margin-left:.25rem;margin-right:.25rem}.mh2{margin-left:.5rem;margin-right:.5rem}.mh3{margin-left:1rem;margin-right:1rem}.mh4{margin-left:2rem;margin-right:2rem}.mh5{margin-left:4rem;margin-right:4rem}.mh6{margin-left:8rem;margin-right:8rem}.mh7{margin-left:16rem;margin-right:16rem}.mw1{max-width:1rem}.mw2{max-width:2rem}.mw3{max-width:4rem}.mw4{max-width:8rem}.mw5{max-width:16rem}.mw6{max-width:32rem}.mw7{max-width:48rem}.mw8{max-width:64rem}.mw9{max-width:96rem}.w-100{width:100%}.dim{opacity:1;-webkit-transition:opacity .15s ease-in;transition:opacity .15s ease-in}.dim:focus,.dim:hover{backface-visibility:hidden;opacity:.5;-webkit-transition:opacity .15s ease-in;transition:opacity .15s ease-in}.dim:active{backface-visibility:hidden;opacity:.8;-webkit-transition:opacity .15s ease-out;transition:opacity .15s ease-out}.grow{-moz-osx-font-smoothing:grayscale;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-transition:-webkit-transform .25s ease-out;transition:-webkit-transform .25s ease-out;transition:transform .25s ease-out;transition:transform .25s ease-out,-webkit-transform .25s ease-out}.grow:focus,.grow:hover{-webkit-transform:scale(1.05);transform:scale(1.05)}.grow:active{-webkit-transform:scale(.9);transform:scale(.9)}.dib{display:inline-block}.h1{height:1rem}.h2{height:2rem}.h3{height:4rem}.h4{height:8rem}.h5{height:16rem}.bb{border-bottom-style:solid;border-bottom-width:1px}.bt{border-top-style:solid;border-top-width:1px}.link{text-decoration:none;-webkit-transition:color .15s ease-in;transition:color .15s ease-in}.link:active,.link:hover,.link:link,.link:visited{-webkit-transition:color .15s ease-in;transition:color .15s ease-in}.link:focus{-webkit-transition:color .15s ease-in;transition:color .15s ease-in;outline:currentColor dotted 1px}.center{margin-right:auto;margin-left:auto}img,video{max-width:100%}    
    /* Extra styles */
    #markup video,body,html{width:100%}#markup aside a,#markup li a,#markup p a,.link-effect{text-decoration:none;transition:color .15s ease-in;border-bottom:1px solid #d0113f}#markup aside p,#markup figure,body,html{margin:0}body,html{padding:0;background:#fff;font-family:avenir next,avenir,helvetica neue,helvetica,ubuntu,roboto,noto,segoe ui,arial,sans-serif;font-weight:400;color:#444;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#markup aside ol,#markup aside p,#markup aside ul{font-weight:500}*{box-sizing:border-box}.hover-red:hover,.red{color:#d0113f}.bg-red{background-color:#d0113f}#home-icon-container{transition:all .15s ease-in-out}#home-icon-container:hover #home-icon{fill:#d0113f}.lh-copy{line-height:1.7}#markup h2,#markup h3,#markup h4{margin-top:3rem;margin-bottom:1rem}#markup aside{margin:30px 0;background:#f1ece9;padding:25px;border-radius:10px}#markup aside.secondary{background:#e3f3f9}#markup aside a,#markup li a,#markup p a{font-weight:600;color:#d0113f;-webkit-box-shadow:inset 0 -2px 0 0 #d0113f;box-shadow:inset 0 -2px 0 0 #d0113f;padding-bottom:2px}#markup aside a:hover,#markup blockquote footer,#markup li a:hover,#markup p a:hover{color:#111}#markup aside h1,#markup aside h2,#markup aside h3,#markup aside h4{margin-top:0}#markup aside img{margin-top:2rem}#markup blockquote{color:#767676;border-left:4px solid #e9e9e9;padding-left:15px;letter-spacing:-1px;font-style:italic;margin:0}#markup li code,#markup p code{background:#f8f8f8;padding:5px}#markup figure code,#markup figure li code{background:#f8f8f8;font-size:.95rem;padding:1rem}@media (max-width:30rem){#markup figure code,#markup figure li code{font-size:.8rem}}#markup img{left:50%;position:relative;transform:translate(-50%,0);top:50%;margin:0 -50% 0 0}@media (min-width:560px){#markup img.small,video.small{max-width:500px}}#markup img.shadow,video.shadow{box-shadow:0 1px 16px 0 rgba(0,0,0,.2),0 2px 8px 0 rgba(0,0,0,.14),0 4px 8px -1px rgba(0,0,0,.12)}#markup .image-source{font-size:16px;margin:0 0 3rem;text-align:center;letter-spacing:.02rem;color:#d0113f;font-weight:700}#markup .image-source.no-margin{margin-bottom:0}.link-effect{font-weight:600;color:#d0113f;-webkit-box-shadow:inset 0 -2px 0 0 #d0113f;box-shadow:inset 0 -2px 0 0 #d0113f;padding-bottom:2px}.link-effect:hover{color:#111}
    /* Github Highlight */
    /* GitHub highlight (slightly modified) */
    .hljs{display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#404040;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:bold}.hljs-number,.hljs-literal,.hljs-variable,.hljs-template-variable,.hljs-tag .hljs-attr{color:#045252}.hljs-string,.hljs-doctag{color:#d14}.hljs-title,.hljs-section,.hljs-selector-id{color:#900;font-weight:bold}.hljs-subst{font-weight:normal}.hljs-type,.hljs-class .hljs-title{color:#458;font-weight:bold}.hljs-tag,.hljs-name,.hljs-attribute{color:#000080;font-weight:normal}.hljs-regexp,.hljs-link{color:#014c13}.hljs-symbol,.hljs-bullet{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#004d67}.hljs-meta{color:#999;font-weight:bold}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:bold}
  </style>
</head>

<body>

  <div class="flex flex-column items-center justify-between">
    <header class="h5 flex items-center">
  <a id="home-icon-container" href="/" aria-label="Home"><svg width="50" height="50" preserveAspectRatio="none" viewBox="0 0 350 350">
  <defs>
    <clipPath id="a">
      <path d="M0 300h500V0H0z"/>
    </clipPath>
  </defs>
  <g clip-path="url(#a)" transform="matrix(1.33333 0 0 -1.33333 -150 390)">
    <path id="home-icon" fill="#1d1d1d" d="M237.4502 130.5498c5 4.967 11.017 7.45 18.05 7.45 7.033 0 13.033-2.483 18-7.45 5-5 7.5-11.017 7.5-18.05 0-7.033-2.5-13.033-7.5-18-4.967-5-10.967-7.5-18-7.5-7.033 0-13.05 2.5-18.05 7.5-4.967 4.967-7.45 10.967-7.45 18 0 7.033 2.483 13.05 7.45 18.05m87.3 56.85l15.099-15.1c2.368-2.367 2.384-4.716.051-7.05l-17.15-17.15c-2.366-2.366-4.734-2.366-7.1 0l-59.551 59.55-59.299-59.3c-.5-.5-.983-.883-1.45-1.15l-53.95-53.95c-2.367-2.366-4.734-2.366-7.1 0l-17.15 17.151c-2.333 2.333-2.317 4.682.05 7.049l61.15 61.15h.3l55.1 55.1h.35l7.85 7.85c4.6 4.6 9.2 6.95 13.8 7.05h.599c3.467-.067 6.934-1.417 10.401-4.05l13.65-12.6-.1-.1 23.2-23.2v13.2c0 3.333 1.667 5 5 5h11.25c3.333 0 5-1.667 5-5z" fill-rule="evenodd"/>
  </g>
</svg></a>
</header>
  </div>

  <div class="flex flex-column justify-between mw7 pb5 center w-100 ph4">
    <div class="flex flex-column mt2 mb5">
      <h1 class="f3 f1-ns ttl mb2 near-black lh-title">
        Progressive Web Apps with Angular: Part 2 - Lazy Loading
      </h1>
      <time class="f5 fw6 red" datetime="2018-12-05 07:30:00 +0000">December 05, 2018</time>
    </div>
    <div id="markup" class="f5 f4-ns lh-copy near-black">
      <p>To explore how to add lazy loading functionality to an Angular app, this article will go through the process of building a relatively small application called <strong>Tour of Thrones</strong>.</p>

<p><img alt="Tour of Thrones" title="Tour of Thrones" data-src="/assets/progressive-angular-applications-2/tour-of-thrones.png" class="lazyload shadow" /></p>

<div class="flex items-center justify-center h3">
  <a class="f6 fw6 link dim ph3 pv2 mb2 dib white bg-red ttu br2 mr2" href="https://tour-of-thrones.firebaseapp.com/home">View App</a>
  <a class="f6 fw6 link dim ph3 pv2 mb2 dib white bg-red ttu br2" href="https://github.com/GoogleChromeLabs/tour-of-thrones">Source Code</a>
</div>

<p><a href="https://anapioficeandfire.com/">An API of Ice and Fire</a> (an unofficial, community-built API for Game of Thrones) will be used to list houses from the book series and provide information about them. While building this application, we’ll explore a number of topics including:</p>

<ul>
  <li>Getting started with Angular CLI</li>
  <li>Lazy loading on scroll</li>
  <li>Lazy loading on route change</li>
  <li>Secondary routes</li>
</ul>

<aside>
  <p>The first half of this article covers how to build the application from scratch. If you're not interested in this, feel free to skip right ahead to the <a href="https://houssein.me/progressive-angular-applications-2#lazy-loading">Lazy Loading</a> section.</p><br />
</aside>

<aside>
  <p>If you would like to first read an introduction to Progressive Angular applications, you can take a look at the <a href="https://houssein.me/progressive-angular-applications">first part</a> of this series.</p>
</aside>

<h2 id="getting-started">Getting Started</h2>

<p>If you have the required <a href="https://angular.io/guide/quickstart#nodejs">Node and NPM versions</a>, you can install Angular CLI with the following command:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">npm install <span class="nt">-g</span> @angular/cli</code></pre></figure>

<p>You can then create a new application with:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ng new tour-of-thrones</code></pre></figure>

<p>If you have Angular CLI 7 installed or a later version, you should see a few questions pop up in your terminal:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">? Would you like to add Angular routing? No
? Which stylesheet format would you like to use?
  CSS
❯ SCSS   <span class="o">[</span> http://sass-lang.com   <span class="o">]</span>
  SASS   <span class="o">[</span> http://sass-lang.com   <span class="o">]</span>
  LESS   <span class="o">[</span> http://lesscss.org     <span class="o">]</span>
  Stylus <span class="o">[</span> http://stylus-lang.com <span class="o">]</span></code></pre></figure>

<p>You can say <em>No</em> to Angular routing for now. We’ll include it manually when we begin to add routing to the application.</p>

<p>Feel free to select whichever stylesheet format you prefer. If you would like to copy over all the styles in this article however, select <code class="highlighter-rouge">SCSS</code>.</p>

<p>To start the app:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd </span>tour-of-thrones
npm start</code></pre></figure>

<p>You should now see Angular’s version of “Hello World”.</p>

<p><img alt="Hello World" title="Hello World" data-src="/assets/progressive-angular-applications-2/hello-world.png" class="lazyload" /></p>

<p>The application will consist of two parts:</p>

<ul>
  <li>A base <code class="highlighter-rouge">home</code> route that lists all the Game of Thrones houses.</li>
</ul>

<p><img alt="Home Route" title="Home Route" data-src="/assets/progressive-angular-applications-2/home-route.png" class="lazyload shadow" /></p>

<ul>
  <li>A secondary <code class="highlighter-rouge">house</code> route that shows information for a particular house in a modal.</li>
</ul>

<p><img alt="House Route" title="House Route" data-src="/assets/progressive-angular-applications-2/house-route.png" class="lazyload shadow" /></p>

<h3 id="first-component">First Component</h3>

<p>Building the first few components in the application is a good way to kick things off. We’ll start with the <code class="highlighter-rouge">HeaderComponent</code> responsible for showing the name of the application in the <code class="highlighter-rouge">home</code> route.</p>

<p>Create a separate <code class="highlighter-rouge">components/</code> directory that contains a separate <code class="highlighter-rouge">header/</code> directory within. This sub-directory can contain all the files needed for <code class="highlighter-rouge">HeaderComponent</code>.</p>

<p><img alt="Header directory" title="Header directory" data-src="/assets/progressive-angular-applications-2/header-directory.png" class="lazyload shadow" /></p>

<p>Starting with the template file, <code class="highlighter-rouge">header.component.html</code>:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/app/component/header/header.component.html --&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"header"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;h1&gt;</span>
    Tour Of Thrones
  <span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;i</span> <span class="na">class=</span><span class="s">"arrow down"</span><span class="nt">&gt;&lt;/i&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<p>Now update the also newly created <code class="highlighter-rouge">header.component.ts</code> file:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/component/header/header.component.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'app-header'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'./header.component.html'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="s1">'./header.component.scss'</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">HeaderComponent</span> <span class="p">{}</span></code></pre></figure>

<p>You can copy and paste the styles for <code class="highlighter-rouge">header.component.scss</code> from <a href="https://github.com/GoogleChromeLabs/tour-of-thrones/blob/master/src/app/component/header/header.component.scss">here</a>. We’ll do this for all the styles in the application.</p>

<p>To simplify how components are imported throughout the app, you can use named exports in the same directory for each component with an <code class="highlighter-rouge">index.ts</code> file. Since <code class="highlighter-rouge">header/</code> is the only component directory we currently have,  exporting within the <code class="highlighter-rouge">index.ts</code> file that lives in the folder:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/component/header/index.ts</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">HeaderComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./header.component'</span><span class="p">;</span></code></pre></figure>

<p>Similarly, you can re-export these components one level higher in an <code class="highlighter-rouge">index.ts</code> file within the <code class="highlighter-rouge">components/</code> directory:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/component/index.ts</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">HeaderComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./header'</span><span class="p">;</span></code></pre></figure>

<p>By default, Angular CLI allows you to import using absolute imports (<code class="highlighter-rouge">import ComponentA from 'src/app/component'</code>). Since all of the files live within the <code class="highlighter-rouge">app</code> directory here, you can modify <code class="highlighter-rouge">baseUrl</code> in <code class="highlighter-rouge">tsconfig.json</code> to import directly from <code class="highlighter-rouge">app</code> and not <code class="highlighter-rouge">src/app</code>:</p>

<pre>
  <code class="language-javascript hljs" data-lang="javascript">
  // tsconfig.json

  {
    "compileOnSave": false,
    "compilerOptions": {
      <s>"baseUrl": "./",</s>
      <strong><i>"baseUrl": "src",</i></strong>
      // ...
    }
  }
  </code>
</pre>

<aside>
  <h4>Why import/export components like this?</h4>

  <p>Normally, you would import multiple components from other files to a parent component like this:</p>

<figure class="highlight"><pre class=" language-javascript"><code class=" language-javascript" data-lang="javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> ComponentA <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../component/component-a'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ComponentB <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../component/component-b'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ComponentC <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../component/component-c'</span><span class="token punctuation">;</span></code></pre></figure>
  
  <p>You can also use <code>index.ts</code> files to re-export components (or any other exports). These are sometimes referred to as <i>barrel</i> files and allow you to simplify how you can import exports into something like this:</p>

  <figure class="highlight"><pre class=" language-javascript"><code class=" language-javascript" data-lang="javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> ComponentA<span class="token punctuation">,</span> ComponentB<span class="token punctuation">,</span> ComponentC <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../component'</span><span class="token punctuation">;</span></code></pre></figure>

  <p>Although the latter approach is used in this article, there is no correct way. There are actually a few issues with the second approach. It can make jumping between files within your editor/IDE harder as well as make autocomplete not work as effectively. If you don't like this, feel free to import/export normally instead of how it's done in this article.</p>
</aside>

<p>The only component (<code class="highlighter-rouge">app.component.ts</code>) and module (<code class="highlighter-rouge">app.module.ts</code>) scaffolded when the project was created live inside of <code class="highlighter-rouge">src/app</code>. You’ll need to modify <code class="highlighter-rouge">AppComponent</code> to include <code class="highlighter-rouge">HeaderComponent</code>:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/app/app.component.html --&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"app"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-header&gt;&lt;/app-header&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<p>You can see the styling in <code class="highlighter-rouge">app.component.scss</code> <a href="https://github.com/GoogleChromeLabs/tour-of-thrones/blob/master/src/app/app.component.scss">here</a>.</p>

<p>You also have to make sure it’s declared in <code class="highlighter-rouge">AppModule</code>:</p>

<figure class="highlight">
<pre>
<code class="language-javascript hljs" data-lang="javascript">// src/app/app.module.ts

import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';

<strong><i>import { HeaderComponent } from 'app/component';</i></strong>
import { AppComponent } from './app.component';

@NgModule({
  declarations: [AppComponent, <strong><i>HeaderComponent</i></strong>],
  imports: [BrowserModule],
  providers: [],
  bootstrap: [AppComponent],
})
export class AppModule {}
</code>
</pre>
</figure>

<p>The last thing you’ll need to do here is to add some global styles to the application (which includes the Thrones-style font). All global styles in an Angular app go to <code class="highlighter-rouge">styles.scss</code> at the root of the <code class="highlighter-rouge">src/</code> directory. Take a look <a href="https://github.com/GoogleChromeLabs/tour-of-thrones/blob/master/src/styles.scss">here</a> to copy over the styles directly.</p>

<aside>
  <p>The "Thrones" font used in the app (created by <a href="https://charliesamways.carbonmade.com/">Charlie Samways</a>) can be found <a href="https://charliesamways.carbonmade.com/projects/4420181#7">here</a>.</p>
</aside>

<h4 id="try-it-out">Try it out</h4>

<p>If you run the application, you’ll notice that the header component renders and takes up a little more than half the screen.</p>

<p><img alt="Header" title="Header" data-src="/assets/progressive-angular-applications-2/header.png" class="lazyload shadow" /></p>

<h2 id="base-route">Base Route</h2>

<p>Now that you’ve got your feet wet building the first component, let’s move on to building everything necessary for the base <code class="highlighter-rouge">/home</code> route. We’ll need:</p>

<ul>
  <li>A card component to display the information of each house</li>
  <li>A routing system in place to define a <code class="highlighter-rouge">/home</code> route</li>
  <li>A service to interface with our external API</li>
</ul>

<p>We’ll start with <code class="highlighter-rouge">CardComponent</code>. Similarly, create a <code class="highlighter-rouge">card/</code> subdirectory within <code class="highlighter-rouge">components/</code> with all of its files:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/app/component/card/card.component.html --&gt;</span>

<span class="nt">&lt;div</span> <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">onClick</span><span class="err">()"</span> <span class="na">class=</span><span class="s">"card grow"</span> <span class="err">[</span><span class="na">ngStyle</span><span class="err">]="</span><span class="na">setBackgroundStyle</span><span class="err">()"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h3&gt;</span>{{name}}<span class="nt">&lt;/h3&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/component/card/card.component.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Input</span><span class="p">,</span> <span class="nx">Output</span><span class="p">,</span> <span class="nx">EventEmitter</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'app-card'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'./card.component.html'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="s1">'./card.component.scss'</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CardComponent</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">Input</span><span class="p">()</span> <span class="nx">id</span><span class="p">:</span> <span class="nb">Number</span><span class="p">;</span>
  <span class="p">@</span><span class="nd">Input</span><span class="p">()</span> <span class="nx">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="p">@</span><span class="nd">Input</span><span class="p">()</span> <span class="nx">color</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="p">@</span><span class="nd">Output</span><span class="p">()</span> <span class="nx">click</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">EventEmitter</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="p">();</span>

  <span class="nx">onClick</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">click</span><span class="p">.</span><span class="nx">emit</span><span class="p">({</span>
      <span class="na">id</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="nx">setBackgroundStyle</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">background</span><span class="p">:</span> <span class="s2">`radial-gradient(</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">color</span><span class="p">}</span><span class="s2">, #39393f)`</span><span class="p">,</span>
      <span class="s1">'box-shadow'</span><span class="p">:</span> <span class="s2">`0 0 60px </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">color</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/component/card/index.ts</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">CardComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./card.component'</span><span class="p">;</span></code></pre></figure>

<p>Finally, you’ll need to update the top-level barrel file:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/component/index.ts</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">CardComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./card'</span><span class="p">;</span>
<span class="k">export</span> <span class="p">{</span> <span class="nx">HeaderComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./header'</span><span class="p">;</span></code></pre></figure>

<ul>
  <li>Input binding is used to pass an <code class="highlighter-rouge">id</code> parameter (the house ID) as well the house name and color. The color isn’t fetched from the API, but is randomly generated to add a little <em>spicyness</em> 🌶 to the app. You’ll see this in a bit.</li>
  <li><code class="highlighter-rouge">ngStyle</code> is used to add <code class="highlighter-rouge">box-shadow</code> and <code class="highlighter-rouge">background</code> CSS properties using this color.</li>
  <li>An <code class="highlighter-rouge">EventEmitter</code> is used to fire a click event to a parent component. We pass the house <code class="highlighter-rouge">id</code> into this event as well.</li>
</ul>

<aside>
<p>Although you could to try to handle all logic within this component, it probably makes more sense to keep it as <i>stateless</i> as possible and let the parent handle what happens on the click event.</p>
</aside>

<p>The styles for the card component can be found <a href="https://github.com/GoogleChromeLabs/tour-of-thrones/blob/master/src/app/component/card/card.component.scss">here</a>. Lastly, you’ll need to declare this component in <code class="highlighter-rouge">AppModule</code> in order to use it:</p>

<figure class="highlight">
<pre>
<code class="language-javascript hljs" data-lang="javascript">// src/app/app.module.ts

// ...

import { HeaderComponent, <strong><i>CardComponent</i></strong> } from 'app/component';

@NgModule({
  declarations: [AppComponent, HeaderComponent, <strong><i>CardComponent</i></strong>],
  // ...
})
// ...
</code>
</pre>
</figure>

<h4 id="try-it-out-1">Try it out</h4>

<p>Let’s add a couple of dummy card components to <code class="highlighter-rouge">AppComponent</code> to see if they’re displaying correctly:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/app/app.component.html --&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"app"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-header&gt;&lt;/app-header&gt;</span>
  <span class="nt">&lt;app-card</span> <span class="na">id=</span><span class="s">"1"</span> <span class="na">name=</span><span class="s">"House Freshness"</span> <span class="na">color=</span><span class="s">"green"</span><span class="nt">&gt;&lt;/app-card&gt;</span>
  <span class="nt">&lt;app-card</span> <span class="na">id=</span><span class="s">"2"</span> <span class="na">name=</span><span class="s">"House Homes"</span> <span class="na">color=</span><span class="s">"red"</span><span class="nt">&gt;&lt;/app-card&gt;</span>
  <span class="nt">&lt;app-card</span> <span class="na">id=</span><span class="s">"3"</span> <span class="na">name=</span><span class="s">"House Juice"</span> <span class="na">color=</span><span class="s">"orange"</span><span class="nt">&gt;&lt;/app-card&gt;</span>
  <span class="nt">&lt;app-card</span> <span class="na">id=</span><span class="s">"4"</span> <span class="na">name=</span><span class="s">"House Replay"</span> <span class="na">color=</span><span class="s">"blue"</span><span class="nt">&gt;&lt;/app-card&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<p><img alt="Card Components" title="Card Components" data-src="/assets/progressive-angular-applications-2/cards.png" class="lazyload shadow" /></p>

<p>Cards are being rendered! They don’t have any specific widths/heights assigned to them and they take the shape of their parent container, which is expected. Once we add the home route next, we’ll use CSS grid to give our cards some structure.</p>

<h2 id="routing">Routing</h2>

<p>It’s time to begin adding some navigation to the application. Instead of placing components that make up the routes in the <code class="highlighter-rouge">component/</code> directory, we’ll put them in a separate directory called <code class="highlighter-rouge">scene/</code>.</p>

<p>Create a separate <code class="highlighter-rouge">scene/</code> directory with a <code class="highlighter-rouge">home/</code> subdirectory. Add all the files for <code class="highlighter-rouge">HomeComponent</code> responsible for the initial route can be added here:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/app/scene/home/home.component.html --&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"grid"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-card</span> 
    <span class="err">*</span><span class="na">ngFor=</span><span class="s">"let house of houses"</span> 
    <span class="err">[</span><span class="na">id</span><span class="err">]="</span><span class="na">house</span><span class="err">.</span><span class="na">id</span><span class="err">"</span> 
    <span class="err">[</span><span class="na">name</span><span class="err">]="</span><span class="na">house</span><span class="err">.</span><span class="na">name</span><span class="err">"</span> 
    <span class="err">[</span><span class="na">color</span><span class="err">]="</span><span class="na">house</span><span class="err">.</span><span class="na">color</span><span class="err">"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/app-card&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c">&lt;!--</span> <span class="nx">src</span><span class="o">/</span><span class="nx">app</span><span class="o">/</span><span class="nx">scene</span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">home</span><span class="p">.</span><span class="nx">component</span><span class="p">.</span><span class="nx">ts</span> <span class="o">--&gt;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'app-home'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'./home.component.html'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="s1">'./home.component.scss'</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">HomeComponent</span> <span class="kr">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>
  <span class="nx">houses</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{}</span>

  <span class="nx">ngOnInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">getHouses</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">getHouses</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">houses</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'House Freshness'</span><span class="p">,</span> <span class="na">color</span><span class="p">:</span> <span class="s1">'green'</span><span class="p">},</span>
      <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'House Homes'</span><span class="p">,</span> <span class="na">color</span><span class="p">:</span> <span class="s1">'red'</span><span class="p">},</span>
      <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'House Juice'</span><span class="p">,</span> <span class="na">color</span><span class="p">:</span> <span class="s1">'orange'</span><span class="p">},</span>
      <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'House Replay'</span><span class="p">,</span> <span class="na">color</span><span class="p">:</span> <span class="s1">'blue'</span><span class="p">},</span>
    <span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/scene/home/index.ts</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">HomeComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./home.component'</span><span class="p">;</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/scene/index.ts</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">HomeComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./home'</span><span class="p">;</span></code></pre></figure>

<p>The styles for this component can be found <a href="https://github.com/GoogleChromeLabs/tour-of-thrones/blob/master/src/app/scene/home/home.component.scss">here</a>. If you take a look at the styles, you’ll notice that the list of cards is wrapped in a grid structure.</p>

<aside>
  <p>We're not going to explain CSS grid in this article, but you can refer to this <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout/Basic_Concepts_of_Grid_Layout">MDN resource</a> if you're interested in learning more.</p>
</aside>

<p>Now let’s define the routes in <code class="highlighter-rouge">AppModule</code>:</p>

<figure class="highlight">
<pre>
<code class="language-javascript hljs" data-lang="javascript">// src/app/app.module.ts

import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';
import { Routes, RouterModule } from '@angular/router';

import { HeaderComponent, CardComponent } from 'app/component';
<strong><i>import { HomeComponent } from 'app/scene';</i></strong>
import { AppComponent } from './app.component';

<strong><i>const routePaths: Routes = [
  {
    path: '',
    redirectTo: 'home',
    pathMatch: 'full',
  },
  {
    path: 'home',
    component: HomeComponent,
  },
];</i></strong>

@NgModule({
  declarations: [AppComponent, HeaderComponent, CardComponent, <strong><i>HomeComponent</i></strong>],
  imports: [BrowserModule, <strong><i>RouterModule.forRoot(routePaths)</i></strong>],
  providers: [],
  bootstrap: [AppComponent],
})
export class AppModule {}
</code>
</pre>
</figure>

<p>We’ve defined a single route path (<code class="highlighter-rouge">home</code>) that maps to a component (<code class="highlighter-rouge">HomeComponent</code>) and we’ve set up the root path to redirect to this. You now need to let the application know where to dynamically load the correct component based on the current route, and you can do that by using <code class="highlighter-rouge">router-outlet</code>:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/app/app.component.html --&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"app"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-header&gt;&lt;/app-header&gt;</span>
  <span class="nt">&lt;router-outlet&gt;&lt;/router-outlet&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<h4 id="try-it-out-2">Try it out</h4>

<p>Take a look at the application now. You’ll see <code class="highlighter-rouge">HomeComponent</code> showing the list of houses in a grid structure.</p>

<p><img alt="Home Component" title="Home Component" data-src="/assets/progressive-angular-applications-2/home-component.png" class="lazyload shadow" /></p>

<p>You can also see that loading the base URL of the application immediately redirects to <code class="highlighter-rouge">/home</code>.</p>

<h2 id="service">Service</h2>

<p>To get some real data, we need to interface with the API. Create a service for this by placing it in a <code class="highlighter-rouge">/service</code> directory:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/service/iceandfire.service.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Injectable</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">HttpClient</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/common/http'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Observable</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'rxjs'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">map</span><span class="p">,</span> <span class="nx">filter</span><span class="p">,</span> <span class="nx">scan</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'rxjs/operators'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">House</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'app/type'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">IceAndFireService</span> <span class="p">{</span>
  <span class="nl">baseUrl</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">http</span><span class="p">:</span> <span class="nx">HttpClient</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">baseUrl</span> <span class="o">=</span> <span class="s1">'https://anapioficeandfire.com/api'</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">fetchHouses</span><span class="p">(</span><span class="nx">page</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">http</span><span class="p">.</span><span class="kd">get</span><span class="o">&lt;</span><span class="nx">House</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">baseUrl</span><span class="p">}</span><span class="s2">/houses?page=</span><span class="p">${</span><span class="nx">page</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">fetchHouse</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="nx">number</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">http</span><span class="p">.</span><span class="kd">get</span><span class="o">&lt;</span><span class="nx">House</span><span class="o">&gt;</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">baseUrl</span><span class="p">}</span><span class="s2">/houses/</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>We’re using Angular’s <code class="highlighter-rouge">HttpClient</code> to interface with the API by defining two separate methods:</p>

<ul>
  <li><code class="highlighter-rouge">fetchHouses</code>: Get a list of houses given a page number</li>
  <li><code class="highlighter-rouge">fetchHouse</code>: Get information about a particular house</li>
</ul>

<p>We’ll also wrap our service in its own module:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/service/service.module.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">NgModule</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">IceAndFireService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./iceandfire.service'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[],</span>
  <span class="na">exports</span><span class="p">:</span> <span class="p">[],</span>
  <span class="na">declarations</span><span class="p">:</span> <span class="p">[],</span>
  <span class="na">providers</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ServicesModule</span> <span class="p">{</span>
  <span class="kr">static</span> <span class="nx">forRoot</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">ngModule</span><span class="p">:</span> <span class="nx">ServicesModule</span><span class="p">,</span>
      <span class="na">providers</span><span class="p">:</span> <span class="p">[</span><span class="nx">IceAndFireService</span><span class="p">],</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">IceAndFireService</span> <span class="p">};</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/service/index.ts</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">IceAndFireService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./iceandfire.service'</span><span class="p">;</span>
<span class="k">export</span> <span class="p">{</span> <span class="nx">ServicesModule</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./service.module'</span><span class="p">;</span></code></pre></figure>

<p>In the service, we type-check with a <code class="highlighter-rouge">House</code> interface. You can add the types and interfaces to a <code class="highlighter-rouge">type/</code> directory:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/type/house.ts</span>
<span class="nx">type</span> <span class="nx">Url</span> <span class="o">=</span> <span class="nx">string</span><span class="p">;</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">House</span> <span class="p">{</span>
  <span class="nl">id</span><span class="p">:</span> <span class="nx">number</span><span class="p">;</span>
  <span class="nl">url</span><span class="p">:</span> <span class="nx">Url</span><span class="p">;</span>
  <span class="nl">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">region</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">coatOfArms</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">words</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">titles</span><span class="p">:</span> <span class="nx">string</span><span class="p">[];</span>
  <span class="nl">seats</span><span class="p">:</span> <span class="nx">string</span><span class="p">[];</span>
  <span class="nl">currentLord</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">heir</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">overlord</span><span class="p">:</span> <span class="nx">Url</span><span class="p">;</span>
  <span class="nl">founded</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">founder</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">diedOut</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="nl">ancestralWeapons</span><span class="p">:</span> <span class="nx">string</span><span class="p">[];</span>
  <span class="nl">cadetBranches</span><span class="p">:</span> <span class="nx">Url</span><span class="p">[];</span>
  <span class="nl">swornMembers</span><span class="p">:</span> <span class="nx">Url</span><span class="p">[];</span>
  <span class="nl">color</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/type/index.ts</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">House</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./house'</span><span class="p">;</span></code></pre></figure>

<p>Now import the services module in <code class="highlighter-rouge">AppModule</code>:</p>

<figure class="highlight">
<pre>
<code class="language-javascript hljs" data-lang="javascript">// src/app/app.module.ts

//...
<strong><i>import { HttpClientModule } from '@angular/common/http';</i></strong>
<strong><i>import { ServicesModule } from 'app/service';</i></strong>
//...

@NgModule({
  //...
  imports: [
    //...
    <strong><i>HttpClientModule,</i></strong>
    <strong><i>ServicesModule.forRoot(),</i></strong>
  ],
  //...
})
export class AppModule {}
</code>
</pre>
</figure>

<p>You can now update <code class="highlighter-rouge">HomeComponent</code> to use the appropriate service method:</p>

<figure class="highlight">
<pre>
<code class="language-javascript hljs" data-lang="javascript">// src/app/scene/home/home.component.ts

import { Component, OnInit } from '@angular/core';

import { IceAndFireService } from 'app/service';
import { House } from 'app/type';

@Component({
  selector: 'app-home',
  templateUrl: './home.component.html',
  styleUrls: ['./home.component.scss'],
})
export class HomeComponent implements OnInit {
  pageNum = 1;
  houses: House[] = [];

  constructor(private service: IceAndFireService) {}

  ngOnInit() {
    this.getHouses();
  }

  <s>getHouses() {
    this.houses = [
      {id: 1, name: 'House Freshness', color: 'green'},
      {id: 2, name: 'House Homes', color: 'red'},
      {id: 3, name: 'House Juice', color: 'orange'},
      {id: 4, name: 'House Replay', color: 'blue'},
    ];
  }</s>

  getHouses(pageNum = 1) {
    this.service.fetchHouses(pageNum).subscribe(
      data =&gt; {
        this.houses = this.houses.concat(
          data.map(datum =&gt; {
            const urlSplit = datum.url.split('/');

            return {
              ...datum,
              id: Number(urlSplit[urlSplit.length - 1]),
              color: getColor(),
            };
          }),
        );
      },
      err =&gt; console.error(err),
    );
  }
}

// utils
const getColor = () =&gt;
  `#${Math.random()
    .toString(16)
    .slice(-6)}66`;
</code>
</pre>
</figure>

<p>Let’s quickly go over what’s happening here:</p>

<ul>
  <li>We’re importing <code class="highlighter-rouge">IceAndFireService</code> and injecting it into the component constructor</li>
  <li>We’re using the <code class="highlighter-rouge">OnInit</code> lifecycle hook to fire the <code class="highlighter-rouge">getHouses</code> class method as soon as our component finishes initializing</li>
  <li>In the service, <code class="highlighter-rouge">this.http.get</code> returns an observable. In the component, the <code class="highlighter-rouge">getHouses</code> method calls the <code class="highlighter-rouge">fetchHouses</code> method and subscribes to the observable returned. Since the API does not have a specific ID attribute for each object, we’re mapping through the response and obtaining the ID from the URL attribute as well as assigning a color to each house.</li>
  <li>At the end, we have <code class="highlighter-rouge">getColor</code>. This is a tiny utility method that returns a color that gets assign for each house. This isn’t <em>exactly</em> random, but it works for now. Also the two digits at the end of the string, <code class="highlighter-rouge">66</code>, represent <a href="https://gist.github.com/lopspower/03fb1cc0ac9f32ef38f4">alpha transparency</a>.</li>
</ul>

<h4 id="try-it-out-3">Try it out</h4>

<p>If you take a look at the application now, you’ll see the first page of houses rendered as soon as you load the application:</p>

<p><img alt="Service" title="Service" data-src="/assets/progressive-angular-applications-2/service.png" class="lazyload shadow" /></p>

<h2 id="lazy-loading">Lazy Loading</h2>

<p>To improve loading times on a web page, we can try to <strong>lazy load</strong> non-critical resources where possible. In other words, we can defer the loading of certain assets until the user actually needs them.</p>

<p>In this application, we’re going to lazy load on two different user actions:</p>

<ul>
  <li>On scroll</li>
  <li>On route change</li>
</ul>

<h3 id="infinite-scrolling">Infinite scrolling</h3>

<p>Infinite scrolling is a lazy loading technique to defer loading of future resources until the user has almost scrolled to the end of their currently visible content.</p>

<p>In this application, we want to be careful with how many houses we fetch over the network as soon as the page loads. Like many APIs, the one we’re using paginates responses which allows us to pass a <code class="highlighter-rouge">?page</code> parameter to iterate over responses. We can add infinite scrolling here to defer loading of future paginated results until the user has almost scrolled to the bottom of the web page.</p>

<p>There is more than one way to lazy load elements that show below the edge of the device viewport:</p>

<ul>
  <li>Using <a href="https://developers.google.com/web/fundamentals/performance/lazy-loading-guidance/images-and-video/#using_event_handlers_the_most_compatible_way">scroll event listeners</a></li>
  <li>Using <a href="https://developers.google.com/web/updates/2016/04/intersectionobserver">Intersection Observer</a></li>
</ul>

<p>For this application, we’ll use <a href="https://github.com/orizens/ngx-infinite-scroll">ngx-infinite-scroll</a>, a community-built library that provides an Angular directive abstraction over changes to the scroll event. With this library, you can listen and fire callback events triggered by scroll behaviour.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">ngx</span><span class="o">-</span><span class="nx">infinite</span><span class="o">-</span><span class="nx">scroll</span> <span class="o">--</span><span class="nx">save</span></code></pre></figure>

<p>You can now import its module into the application:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/app.module.ts</span>

<span class="c1">//...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">InfiniteScrollModule</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'ngx-infinite-scroll'</span><span class="p">;</span>
<span class="c1">//...</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
    <span class="c1">//...</span>
    <span class="nx">InfiniteScrollModule</span><span class="p">,</span>
  <span class="p">],</span>
  <span class="c1">//...</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppModule</span> <span class="p">{}</span></code></pre></figure>

<p>And add it to <code class="highlighter-rouge">HomeComponent</code>:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/app/scene/home/home.component.html --&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"grid"</span> <span class="na">infinite-scroll</span> <span class="err">(</span><span class="na">scrolled</span><span class="err">)="</span><span class="na">onScrollDown</span><span class="err">()"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-card</span> 
    <span class="err">*</span><span class="na">ngFor=</span><span class="s">"let house of houses"</span> 
    <span class="err">[</span><span class="na">id</span><span class="err">]="</span><span class="na">house</span><span class="err">.</span><span class="na">id</span><span class="err">"</span> 
    <span class="err">[</span><span class="na">name</span><span class="err">]="</span><span class="na">house</span><span class="err">.</span><span class="na">name</span><span class="err">"</span> 
    <span class="err">[</span><span class="na">color</span><span class="err">]="</span><span class="na">house</span><span class="err">.</span><span class="na">color</span><span class="err">"</span> 
    <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">routeToHouse</span><span class="err">($</span><span class="na">event</span><span class="err">)"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/app-card&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/scene/home/home.component.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">IceAndFireService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'app/service'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">House</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'app/type'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'app-home'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'./home.component.html'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="s1">'./home.component.scss'</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">HomeComponent</span> <span class="kr">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>
  <span class="c1">//...</span>

  <span class="nx">onScrollDown</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pageNum</span><span class="o">++</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">getHouses</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pageNum</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>We just added <code class="highlighter-rouge">onScrollDown</code> as a callback for the directive <code class="highlighter-rouge">scrolled</code> method. In here, we increment the page number and call the <code class="highlighter-rouge">getHouses</code> method.</p>

<p>Now if you try running the application, you’ll see houses load as you scroll down the page.</p>

<p><img alt="Infinite Scroll" title="Infinite Scroll" data-src="/assets/progressive-angular-applications-2/infinite-scroll.gif" class="lazyload shadow" /></p>

<p>The library allows users to customize a number of attributes such as modifying the distance of the current scroll location with respect to the end of the container that determines when to fire an event. You can refer to the <a href="https://github.com/orizens/ngx-infinite-scroll">README</a> for more information.</p>

<aside>
  <p>If you're interested in learning how to build your own infinite scroll directive without the use of additional libraries, Ashwin Sureshkumar has a write-up you can refer to <a href="https://codeburst.io/angular-2-simple-infinite-scroller-directive-with-rxjs-observables-a989b12d4fb1">here</a>.</p>
</aside>

<h4 id="when-should-we-lazy-load-on-scroll">When should we lazy load on scroll?</h4>

<p>There are countless ways to organize a paginated list of results in an application like this, and an infinitely long list is definitely not the best way. Many social media platforms (such as <a href="https://twitter.com/">Twitter</a>) use this model to keep users engaged, but it is not suitable for when the user needs to find a specific piece of information quickly.</p>

<p>In this application for example, it would take a user a very long time to find information about a particular house. Adding normal pagination, allowing the user to filter by region or name, or allowing them to search for a particular house are all probably better ways of doing this.</p>

<p>Instead of trying to lazy load <em>all</em> the content that is displayed to the user as they scroll (i.e. infinite scroll), it might be more worthwhile to try and defer loading of certain elements that aren’t immediately visible to users on page load. Elements such as images and video can consume significant amounts of user bandwidth and lazy loading them specifically will not necessarily affect the entire paginated flow of the application.</p>

<aside>
  <p>Addy Osmani has an excellent section on lazy loading images in his <a href="https://images.guide/#lazy-load-non-critical-images">guide to image optimization</a> and Jeremy Wagner has a great <a href="https://developers.google.com/web/fundamentals/performance/lazy-loading-guidance/images-and-video/">article</a> on the topic as well.</p>
</aside>

<h4 id="how-should-we-lazy-load-on-scroll">How should we lazy load on scroll?</h4>

<p>Finding a library that makes it easier to lazy load elements but uses scroll event listeners is a start. If possible however, try to find a solution that relies on IntersectionObserver but also provides a polyfill for browsers that do not yet support it. Here’s a <a href="https://blog.angularindepth.com/a-modern-solution-to-lazy-loading-using-intersection-observer-9280c149bbc">handy article</a> that shows you how to create an Angular directive with IntersectionObserver.</p>

<aside><p>Psst...Chrome will soon let you <a href="https://youtu.be/reztLS3vomE?t=643">lazy load images and iframes</a> without relying on a third-party library or custom solution.</p></aside>

<h3 id="code-splitting">Code splitting</h3>

<p>Code splitting refers to the practice of splitting the application bundle into separate chunks that can be lazy loaded on demand. In other words, instead of providing users with all the code that makes up the application when they load the very first page, you can give them pieces of the bundle as they navigate throughout the app.</p>

<p>You can apply code splitting in different ways, but it commonly happens on the route level. Webpack, the module bundler used by Angular CLI, has code splitting <a href="https://webpack.js.org/guides/code-splitting/">built-in</a>. Without needing to dive in to the internals of our Webpack configurations in order to make this work, Angular router allows you to lazy-load any feature module that you build.</p>

<p>Let’s see this in action by building our next route, <code class="highlighter-rouge">/house</code>, which shows information for a single house:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/app/scene/house/house.component.html --&gt;</span>

<span class="nt">&lt;app-modal</span> <span class="err">(</span><span class="na">modalClose</span><span class="err">)="</span><span class="na">modalClose</span><span class="err">()"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">modal-loader</span> <span class="err">*</span><span class="na">ngIf=</span><span class="s">"!house; else houseContent"</span> <span class="na">class=</span><span class="s">"loader-container"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;app-loader&gt;&lt;/app-loader&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;ng-template</span> <span class="err">#</span><span class="na">houseContent</span> <span class="na">modal-content</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1&gt;</span>{{house.name}}<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;div</span> <span class="err">*</span><span class="na">ngIf=</span><span class="s">"house.words !== ''"</span> <span class="na">class=</span><span class="s">"subheading"</span><span class="nt">&gt;</span>{{house.words}}<span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"info"</span> <span class="err">[</span><span class="na">ngClass</span><span class="err">]="(</span><span class="na">house</span><span class="err">.</span><span class="na">words =</span><span class="s">==</span> <span class="err">'')</span> <span class="err">?</span> <span class="err">'</span><span class="na">info-large-margin</span><span class="err">'</span> <span class="na">:</span> <span class="err">'</span><span class="na">info-small-margin</span><span class="err">'"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"detail"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"caption"</span><span class="nt">&gt;</span>Coat of Arms<span class="nt">&lt;/p&gt;</span>
          <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"body"</span><span class="nt">&gt;</span>{{house.coatOfArms === '' ? '?' : house.coatOfArms}}<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"detail"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"caption"</span><span class="nt">&gt;</span>Region<span class="nt">&lt;/p&gt;</span>
          <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"body"</span><span class="nt">&gt;</span>{{house.region === '' ? '?' : house.region}}<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"detail"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"caption"</span><span class="nt">&gt;</span>Founded<span class="nt">&lt;/p&gt;</span>
          <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"body"</span><span class="nt">&gt;</span>{{house.founded === '' ? '?' : house.founded}}<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/ng-template&gt;</span>
<span class="nt">&lt;/app-modal&gt;</span></code></pre></figure>

<p>The <code class="highlighter-rouge">HouseComponent</code> shows a number of details for the house selected. It is rendered within a modal and for that reason, its contents are wrapped within an <code class="highlighter-rouge">&lt;app-modal&gt;</code> component. We’re not going to into too much detail on how this modal component files are written, but you can find them <a href="https://github.com/GoogleChromeLabs/tour-of-thrones/tree/master/src/app/component/modal">here</a>.</p>

<aside>
  <p>In case you're wondering how the <code>#houseContent</code> attribute works in this template - it's used to render the entire <code>ng-template</code> block if the expression passed into <code>*ngIf</code> is falsy.</p>
</aside>

<p>One important thing to mention is that we’re using projection (<code class="highlighter-rouge">ng-content</code>) to project content into our modal. We either project a loading state (<code class="highlighter-rouge">modal-loader</code>) if we don’t have any house information yet or modal content (<code class="highlighter-rouge">modal-content</code>) if we do. You can find the code that makes up our loader <a href="https://github.com/GoogleChromeLabs/tour-of-thrones/tree/master/src/app/component/loader">here</a>.</p>

<p>Although we’re only using our modal wrapper for a single component in this application, projection is used to make it more reusable. This can be useful if we happen to need to use a modal in any other part of the application.</p>

<p>Unlike the <code class="highlighter-rouge">HomeComponent</code> which is being bundled directly with the root <code class="highlighter-rouge">AppModule</code>, you can create a separate feature module for <code class="highlighter-rouge">HouseComponent</code> that can be lazy loaded:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/scene/house/house.module.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">NgModule</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">CommonModule</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/common'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">RouterModule</span><span class="p">,</span> <span class="nx">Routes</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/router'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">ModalComponent</span><span class="p">,</span> <span class="nx">LoaderComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'app/component'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">HouseComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./house.component'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">routes</span><span class="p">:</span> <span class="nx">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">component</span><span class="p">:</span> <span class="nx">HouseComponent</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">];</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span><span class="nx">CommonModule</span><span class="p">,</span> <span class="nx">RouterModule</span><span class="p">,</span> <span class="nx">RouterModule</span><span class="p">.</span><span class="nx">forChild</span><span class="p">(</span><span class="nx">routes</span><span class="p">)],</span>
  <span class="na">declarations</span><span class="p">:</span> <span class="p">[</span><span class="nx">HouseComponent</span><span class="p">,</span> <span class="nx">ModalComponent</span><span class="p">,</span> <span class="nx">LoaderComponent</span><span class="p">],</span>
  <span class="na">exports</span><span class="p">:</span> <span class="p">[</span><span class="nx">HouseComponent</span><span class="p">,</span> <span class="nx">RouterModule</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">HouseModule</span> <span class="p">{}</span></code></pre></figure>

<p>Now let’s move on to the logic behind this component:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/scene/house/house.component.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">OnInit</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Router</span><span class="p">,</span> <span class="nx">ActivatedRoute</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/router'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">IceAndFireService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'app/service'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">House</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'app/type'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'app-house'</span><span class="p">,</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s1">'./house.component.html'</span><span class="p">,</span>
  <span class="na">styleUrls</span><span class="p">:</span> <span class="p">[</span><span class="s1">'./house.component.scss'</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">HouseComponent</span> <span class="kr">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>
  <span class="nl">house</span><span class="p">:</span> <span class="nx">House</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span>
    <span class="kr">private</span> <span class="nx">service</span><span class="p">:</span> <span class="nx">IceAndFireService</span><span class="p">,</span>
    <span class="kr">private</span> <span class="nx">router</span><span class="p">:</span> <span class="nx">Router</span><span class="p">,</span>
    <span class="kr">private</span> <span class="nx">route</span><span class="p">:</span> <span class="nx">ActivatedRoute</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{}</span>

  <span class="nx">ngOnInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">params</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">service</span>
        <span class="p">.</span><span class="nx">fetchHouse</span><span class="p">(</span><span class="o">+</span><span class="nx">params</span><span class="p">[</span><span class="s1">'id'</span><span class="p">])</span>
        <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">house</span> <span class="o">=</span> <span class="nx">data</span><span class="p">),</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">));</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="nx">modalClose</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([{</span> <span class="na">outlets</span><span class="p">:</span> <span class="p">{</span> <span class="na">modal</span><span class="p">:</span> <span class="kc">null</span> <span class="p">}</span> <span class="p">}]);</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>In here, we subscribe to our route parameters after the component finishes initializing in order to obtain the house ID. We then fire an API call to fetch its information.</p>

<p>We also have a <code class="highlighter-rouge">modalClose</code> method that navigates to a modal outlet with a value of <code class="highlighter-rouge">null</code>. We do this to clear our modal’s <strong>secondary route</strong>.</p>

<h3 id="secondary-routes">Secondary routes</h3>

<p>In Angular, we can create any number of <em>named</em> router outlets in order to create <a href="https://angular.io/guide/router#displaying-multiple-routes-in-named-outlets">secondary routes</a>. This can be useful to separate different parts of the application in terms of router configurations that don’t need to fit into the primary router outlet. A good example of using this is for a modal or popup.</p>

<p>Let’s begin by defining the second router outlet:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/app/app.component.html --&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"app"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-header&gt;&lt;/app-header&gt;</span>
  <span class="nt">&lt;router-outlet&gt;&lt;/router-outlet&gt;</span>
  <span class="nt">&lt;router-outlet</span> <span class="na">name=</span><span class="s">"modal"</span><span class="nt">&gt;&lt;/router-outlet&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<p>Unlike the primary router outlet, secondary outlets must be named. For this example, we’ve named it <code class="highlighter-rouge">modal</code>.</p>

<p>Now add <code class="highlighter-rouge">HomeModule</code> into the top-level route configurations while lazy loading it. This can be done by using a <code class="highlighter-rouge">loadChildren</code> attribute:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/app.module.ts</span>

<span class="c1">//....</span>

<span class="kd">const</span> <span class="nx">routePaths</span><span class="p">:</span> <span class="nx">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">redirectTo</span><span class="p">:</span> <span class="s1">'home'</span><span class="p">,</span>
    <span class="na">pathMatch</span><span class="p">:</span> <span class="s1">'full'</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">'home'</span><span class="p">,</span>
    <span class="na">component</span><span class="p">:</span> <span class="nx">HomeComponent</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">'house/:id'</span><span class="p">,</span>
    <span class="na">outlet</span><span class="p">:</span> <span class="s1">'modal'</span><span class="p">,</span>
    <span class="na">loadChildren</span><span class="p">:</span> <span class="s1">'app/scene/house/house.module#HouseModule'</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">];</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="c1">//...</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppModule</span> <span class="p">{}</span></code></pre></figure>

<p>Although using a <code class="highlighter-rouge">loadChildren</code> attribute with a value of the path to the module would normally work, there’s an <a href="https://github.com/angular/angular/issues/12842">open issue</a> about a bug that occurs while lazy loading a module tied to a named outlet (secondary route).</p>

<p>In the same issue thread, somebody suggests a <a href="https://github.com/angular/angular/issues/12842#issuecomment-270836368">workaround</a> that involves adding a route proxy component in between:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/app/app.module.ts</span>

<span class="k">import</span> <span class="p">{</span>
  <span class="c1">//...</span>
  <span class="nx">RouteProxyComponent</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="s1">'app/component'</span><span class="p">;</span>

<span class="c1">//...</span>

<span class="kd">const</span> <span class="nx">routePaths</span><span class="p">:</span> <span class="nx">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">redirectTo</span><span class="p">:</span> <span class="s1">'home'</span><span class="p">,</span>
    <span class="na">pathMatch</span><span class="p">:</span> <span class="s1">'full'</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">'home'</span><span class="p">,</span>
    <span class="na">component</span><span class="p">:</span> <span class="nx">HomeComponent</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">'house/:id'</span><span class="p">,</span>
    <span class="na">outlet</span><span class="p">:</span> <span class="s1">'modal'</span><span class="p">,</span>
    <span class="na">component</span><span class="p">:</span> <span class="nx">RouteProxyComponent</span><span class="p">,</span>
    <span class="na">children</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">path</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
        <span class="na">loadChildren</span><span class="p">:</span> <span class="s1">'app/scene/house/house.module#HouseModule'</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">],</span>
  <span class="p">},</span>
<span class="p">];</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="c1">//...</span>
  <span class="na">declarations</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">RouteProxyComponent</span><span class="p">,</span>
  <span class="p">],</span>
  <span class="c1">//...</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppModule</span> <span class="p">{}</span></code></pre></figure>

<p>This workaround works for now, but it does add an extra component layer in between. You can see how the <code class="highlighter-rouge">RouteProxyComponent</code> is nothing more than a single router outlet <a href="https://github.com/GoogleChromeLabs/tour-of-thrones/tree/master/src/app/component/route-proxy">here</a>.</p>

<p>The last thing you’ll need to do is allow the user to switch routes when a house is clicked:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// src/scene/home/home.component.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">Router</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/router'</span><span class="p">;</span>

<span class="c1">//...</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">HomeComponent</span> <span class="kr">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>
  <span class="c1">//...</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">service</span><span class="p">:</span> <span class="nx">IceAndFireService</span><span class="p">,</span> <span class="kr">private</span> <span class="nx">router</span><span class="p">:</span> <span class="nx">Router</span><span class="p">)</span> <span class="p">{}</span>

  <span class="c1">//...</span>

  <span class="nx">routeToHouse</span><span class="p">(</span><span class="nx">event</span><span class="p">:</span> <span class="p">{</span> <span class="nl">id</span><span class="p">:</span> <span class="nx">number</span> <span class="p">})</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">([{</span> <span class="na">outlets</span><span class="p">:</span> <span class="p">{</span> <span class="na">modal</span><span class="p">:</span> <span class="p">[</span><span class="s1">'house'</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="p">}</span> <span class="p">}]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c1">//...</span>
<span class="p">}</span></code></pre></figure>

<p>A <code class="highlighter-rouge">routeToHouse</code> method that navigates to a modal outlet with an array for link parameters was added here. Since <code class="highlighter-rouge">HouseComponent</code> looks up the ID of the house in our route parameters, we’ve included it here in the array.</p>

<p>Now add a click handler to bind to this event:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- src/scene/home/home.component.html --&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"grid"</span> <span class="na">infinite-scroll</span> <span class="err">(</span><span class="na">scrolled</span><span class="err">)="</span><span class="na">onScrollDown</span><span class="err">()"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-card</span> 
    <span class="err">*</span><span class="na">ngFor=</span><span class="s">"let house of houses"</span> 
    <span class="err">[</span><span class="na">id</span><span class="err">]="</span><span class="na">house</span><span class="err">.</span><span class="na">id</span><span class="err">"</span> 
    <span class="err">[</span><span class="na">name</span><span class="err">]="</span><span class="na">house</span><span class="err">.</span><span class="na">name</span><span class="err">"</span> 
    <span class="err">[</span><span class="na">color</span><span class="err">]="</span><span class="na">house</span><span class="err">.</span><span class="na">color</span><span class="err">"</span>
    <span class="err">(</span><span class="na">click</span><span class="err">)="</span><span class="na">routeToHouse</span><span class="err">($</span><span class="na">event</span><span class="err">)"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/app-card&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<h4 id="try-it-out-4">Try it out</h4>

<p>Load the application with these changes and click on any house.</p>

<p><img alt="House Module" title="House Module" data-src="/assets/progressive-angular-applications-2/house-module.png" class="lazyload shadow" /></p>

<p>If you have the <em>Network</em> tab of your browser’s developer tools open, you’ll notice that the code that makes up the house module is only loaded when you click on a house.</p>

<aside>
  <p>Notice that the URL for our secondary route tied to our named modal outlet is <code>.../home(modal:house/1)</code>. In here, <code>home</code> is still our primary route. For more information on how secondary routes work, take a look at the detailed <a href="https://angular.io/guide/router#secondary-routes">documentation</a>.</p>
</aside>

<h4 id="when-should-we-code-split">When should we code split?</h4>

<p>It depends. In this example, the code that makes up the lazy loaded feature module is less than 3KB minified + gzipped (on a production build). If you think this does not warrant code splitting, you might be right.</p>

<p>Lazy loading feature modules can be a lot more useful when your application starts growing with each module making up a juicy cut of the entire bundle. Many developers think code-splitting should be one of the first things to consider when trying to improve the performance of an application, and rightly so.</p>

<p><img alt="Sean Larkin tweet on the importance of code-splitting" title="Sean Larkin tweet on the importance of code-splitting" data-src="/assets/progressive-angular-applications-2/sean-larkin-tweet.png" class="lazyload shadow small" /></p>

<p class="image-source"><a href="https://twitter.com/thelarkinn/status/1017052742039326721?lang=en">Tweet Source</a></p>

<p>Building feature modules is useful to separate concerns in an Angular application. As you continue to grow your Angular app, you’ll most likely reach a point where you realize that code-splitting some modules can cut down the initial page size significantly.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In this article, we built an Angular 7 app from scratch as well as explored how lazy loading can be useful to optimize its performance. I was planning to also cover <code class="highlighter-rouge">@angular/service-worker</code> and how it fits into the CLI in this post, but it turned out to be a bit longer than I expected :). We’ll explore that in the next part of the series.</p>

    </div>

    <div class="f5 fw6 lh-copy mt5">
      <p>If you have any questions or suggestions, feel free to open an
        <a class="link-effect" href="https://github.com/housseindjirdeh/housseindjirdeh.github.io/issues/new">issue!</a>
      </p>
    </div>

    <div class="flex flex-column items-center mt6 mt7-ns mb5">
	<p class="grow">
		<a class="f4 fw6 link near-black hover-red ttl" href="https://twitter.com/hdjirdeh" rel="noopener noreferrer" target="_blank">
			Houssein Djirdeh
		</a>
	</p>
</div>
  </div>
  
  <script>
  /*! highlight.js v9.12.0 | BSD3 License | git.io/hljslicense */
  !function(e){var t="object"==typeof window&&window||"object"==typeof self&&self;"undefined"!=typeof exports?e(exports):t&&(t.hljs=e({}),"function"==typeof define&&define.amd&&define([],function(){return t.hljs}))}(function(e){function t(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function r(e){return e.nodeName.toLowerCase()}function n(e,t){var r=e&&e.exec(t);return r&&0===r.index}function a(e){return v.test(e)}function c(e){var t,r={},n=Array.prototype.slice.call(arguments,1);for(t in e)r[t]=e[t];return n.forEach(function(e){for(t in e)r[t]=e[t]}),r}function i(e){var t=[];return function e(n,a){for(var c=n.firstChild;c;c=c.nextSibling)3===c.nodeType?a+=c.nodeValue.length:1===c.nodeType&&(t.push({event:"start",offset:a,node:c}),a=e(c,a),r(c).match(/br|hr|img|input/)||t.push({event:"stop",offset:a,node:c}));return a}(e,0),t}function s(e){function t(e){return e&&e.source||e}function r(r,n){return new RegExp(t(r),"m"+(e.cI?"i":"")+(n?"g":""))}!function n(a,i){if(!a.compiled){if(a.compiled=!0,a.k=a.k||a.bK,a.k){var s={},o=function(t,r){e.cI&&(r=r.toLowerCase()),r.split(" ").forEach(function(e){var r=e.split("|");s[r[0]]=[t,r[1]?Number(r[1]):1]})};"string"==typeof a.k?o("keyword",a.k):d(a.k).forEach(function(e){o(e,a.k[e])}),a.k=s}a.lR=r(a.l||/\w+/,!0),i&&(a.bK&&(a.b="\\b("+a.bK.split(" ").join("|")+")\\b"),a.b||(a.b=/\B|\b/),a.bR=r(a.b),a.e||a.eW||(a.e=/\B|\b/),a.e&&(a.eR=r(a.e)),a.tE=t(a.e)||"",a.eW&&i.tE&&(a.tE+=(a.e?"|":"")+i.tE)),a.i&&(a.iR=r(a.i)),null==a.r&&(a.r=1),a.c||(a.c=[]),a.c=Array.prototype.concat.apply([],a.c.map(function(e){return(t="self"===e?a:e).v&&!t.cached_variants&&(t.cached_variants=t.v.map(function(e){return c(t,{v:null},e)})),t.cached_variants||t.eW&&[c(t)]||[t];var t})),a.c.forEach(function(e){n(e,a)}),a.starts&&n(a.starts,i);var l=a.c.map(function(e){return e.bK?"\\.?("+e.b+")\\.?":e.b}).concat([a.tE,a.i]).map(t).filter(Boolean);a.t=l.length?r(l.join("|"),!0):{exec:function(){return null}}}}(e)}function o(e,r,a,c){function i(e,t,r,n){var a='<span class="'+(n?"":E.classPrefix);return(a+=e+'">')+t+(r?"":y)}function u(){N+=null!=m.sL?function(){var e="string"==typeof m.sL;if(e&&!h[m.sL])return t(w);var r=e?o(m.sL,w,!0,v[m.sL]):l(w,m.sL.length?m.sL:void 0);return m.r>0&&(M+=r.r),e&&(v[m.sL]=r.top),i(r.language,r.value,!1,!0)}():function(){var e,r,n,a,c,s,o;if(!m.k)return t(w);for(a="",r=0,m.lR.lastIndex=0,n=m.lR.exec(w);n;)a+=t(w.substring(r,n.index)),c=m,s=n,o=g.cI?s[0].toLowerCase():s[0],e=c.k.hasOwnProperty(o)&&c.k[o],e?(M+=e[1],a+=i(e[0],t(n[0]))):a+=t(n[0]),r=m.lR.lastIndex,n=m.lR.exec(w);return a+t(w.substr(r))}(),w=""}function f(e){N+=e.cN?i(e.cN,"",!0):"",m=Object.create(e,{parent:{value:m}})}function b(e,t){if(w+=e,null==t)return u(),0;var r=function(e,t){var r,a;for(r=0,a=t.c.length;a>r;r++)if(n(t.c[r].bR,e))return t.c[r]}(t,m);if(r)return r.skip?w+=t:(r.eB&&(w+=t),u(),r.rB||r.eB||(w=t)),f(r),r.rB?0:t.length;var c,i=function e(t,r){if(n(t.eR,r)){for(;t.endsParent&&t.parent;)t=t.parent;return t}return t.eW?e(t.parent,r):void 0}(m,t);if(i){var s=m;s.skip?w+=t:(s.rE||s.eE||(w+=t),u(),s.eE&&(w=t));do{m.cN&&(N+=y),m.skip||(M+=m.r),m=m.parent}while(m!==i.parent);return i.starts&&f(i.starts),s.rE?0:t.length}if(c=t,!a&&n(m.iR,c))throw new Error('Illegal lexeme "'+t+'" for mode "'+(m.cN||"<unnamed>")+'"');return w+=t,t.length||1}var g=p(e);if(!g)throw new Error('Unknown language: "'+e+'"');s(g);var d,m=c||g,v={},N="";for(d=m;d!==g;d=d.parent)d.cN&&(N=i(d.cN,"",!0)+N);var w="",M=0;try{for(var x,R,C=0;m.t.lastIndex=C,x=m.t.exec(r);)R=b(r.substring(C,x.index),x[0]),C=x.index+R;for(b(r.substr(C)),d=m;d.parent;d=d.parent)d.cN&&(N+=y);return{r:M,value:N,language:e,top:m}}catch(e){if(e.message&&-1!==e.message.indexOf("Illegal"))return{r:0,value:t(r)};throw e}}function l(e,r){r=r||E.languages||d(h);var n={r:0,value:t(e)},a=n;return r.filter(p).forEach(function(t){var r=o(t,e,!1);r.language=t,r.r>a.r&&(a=r),r.r>n.r&&(a=n,n=r)}),a.language&&(n.second_best=a),n}function u(e){return E.tabReplace||E.useBR?e.replace(w,function(e,t){return E.useBR&&"\n"===e?"<br>":E.tabReplace?t.replace(/\t/g,E.tabReplace):""}):e}function f(e){var n,c,s,f,b,d,h,v,w,y,M=function(e){var t,r,n,c,i=e.className+" ";if(i+=e.parentNode?e.parentNode.className:"",r=N.exec(i))return p(r[1])?r[1]:"no-highlight";for(t=0,n=(i=i.split(/\s+/)).length;n>t;t++)if(c=i[t],a(c)||p(c))return c}(e);a(M)||(E.useBR?(n=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=e.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):n=e,b=n.textContent,s=M?o(M,b,!0):l(b),(c=i(n)).length&&((f=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=s.value,s.value=function(e,n,a){function c(){return e.length&&n.length?e[0].offset!==n[0].offset?e[0].offset<n[0].offset?e:n:"start"===n[0].event?e:n:e.length?e:n}function i(e){u+="<"+r(e)+g.map.call(e.attributes,function(e){return" "+e.nodeName+'="'+t(e.value).replace('"',"&quot;")+'"'}).join("")+">"}function s(e){u+="</"+r(e)+">"}function o(e){("start"===e.event?i:s)(e.node)}for(var l=0,u="",f=[];e.length||n.length;){var b=c();if(u+=t(a.substring(l,b[0].offset)),l=b[0].offset,b===e){f.reverse().forEach(s);do{o(b.splice(0,1)[0]),b=c()}while(b===e&&b.length&&b[0].offset===l);f.reverse().forEach(i)}else"start"===b[0].event?f.push(b[0].node):f.pop(),o(b.splice(0,1)[0])}return u+t(a.substr(l))}(c,i(f),b)),s.value=u(s.value),e.innerHTML=s.value,e.className=(d=e.className,h=M,v=s.language,w=h?m[h]:v,y=[d.trim()],d.match(/\bhljs\b/)||y.push("hljs"),-1===d.indexOf(w)&&y.push(w),y.join(" ").trim()),e.result={language:s.language,re:s.r},s.second_best&&(e.second_best={language:s.second_best.language,re:s.second_best.r}))}function b(){if(!b.called){b.called=!0;var e=document.querySelectorAll("pre code");g.forEach.call(e,f)}}function p(e){return e=(e||"").toLowerCase(),h[e]||h[m[e]]}var g=[],d=Object.keys,h={},m={},v=/^(no-?highlight|plain|text)$/i,N=/\blang(?:uage)?-([\w-]+)\b/i,w=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,y="</span>",E={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0};return e.highlight=o,e.highlightAuto=l,e.fixMarkup=u,e.highlightBlock=f,e.configure=function(e){E=c(E,e)},e.initHighlighting=b,e.initHighlightingOnLoad=function(){addEventListener("DOMContentLoaded",b,!1),addEventListener("load",b,!1)},e.registerLanguage=function(t,r){var n=h[t]=r(e);n.aliases&&n.aliases.forEach(function(e){m[e]=t})},e.listLanguages=function(){return d(h)},e.getLanguage=p,e.inherit=c,e.IR="[a-zA-Z]\\w*",e.UIR="[a-zA-Z_]\\w*",e.NR="\\b\\d+(\\.\\d+)?",e.CNR="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",e.BNR="\\b(0b[01]+)",e.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",e.BE={b:"\\\\[\\s\\S]",r:0},e.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[e.BE]},e.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[e.BE]},e.PWM={b:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},e.C=function(t,r,n){var a=e.inherit({cN:"comment",b:t,e:r,c:[]},n||{});return a.c.push(e.PWM),a.c.push({cN:"doctag",b:"(?:TODO|FIXME|NOTE|BUG|XXX):",r:0}),a},e.CLCM=e.C("//","$"),e.CBCM=e.C("/\\*","\\*/"),e.HCM=e.C("#","$"),e.NM={cN:"number",b:e.NR,r:0},e.CNM={cN:"number",b:e.CNR,r:0},e.BNM={cN:"number",b:e.BNR,r:0},e.CSSNM={cN:"number",b:e.NR+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",r:0},e.RM={cN:"regexp",b:/\//,e:/\/[gimuy]*/,i:/\n/,c:[e.BE,{b:/\[/,e:/\]/,r:0,c:[e.BE]}]},e.TM={cN:"title",b:e.IR,r:0},e.UTM={cN:"title",b:e.UIR,r:0},e.METHOD_GUARD={b:"\\.\\s*"+e.UIR,r:0},e}),hljs.registerLanguage("css",function(e){var t={b:/[A-Z\_\.\-]+\s*:/,rB:!0,e:";",eW:!0,c:[{cN:"attribute",b:/\S/,e:":",eE:!0,starts:{eW:!0,eE:!0,c:[{b:/[\w-]+\(/,rB:!0,c:[{cN:"built_in",b:/[\w-]+/},{b:/\(/,e:/\)/,c:[e.ASM,e.QSM]}]},e.CSSNM,e.QSM,e.ASM,e.CBCM,{cN:"number",b:"#[0-9A-Fa-f]+"},{cN:"meta",b:"!important"}]}}]};return{cI:!0,i:/[=\/|'\$]/,c:[e.CBCM,{cN:"selector-id",b:/#[A-Za-z0-9_-]+/},{cN:"selector-class",b:/\.[A-Za-z0-9_-]+/},{cN:"selector-attr",b:/\[/,e:/\]/,i:"$"},{cN:"selector-pseudo",b:/:(:)?[a-zA-Z0-9\_\-\+\(\)"'.]+/},{b:"@(font-face|page)",l:"[a-z-]+",k:"font-face page"},{b:"@",e:"[{;]",i:/:/,c:[{cN:"keyword",b:/\w+/},{b:/\s/,eW:!0,eE:!0,r:0,c:[e.ASM,e.QSM,e.CSSNM]}]},{cN:"selector-tag",b:"[a-zA-Z-][a-zA-Z0-9_-]*",r:0},{b:"{",e:"}",i:/\S/,c:[e.CBCM,t]}]}}),hljs.registerLanguage("bash",function(e){var t={cN:"variable",v:[{b:/\$[\w\d#@][\w\d_]*/},{b:/\$\{(.*?)}/}]},r={cN:"string",b:/"/,e:/"/,c:[e.BE,t,{cN:"variable",b:/\$\(/,e:/\)/,c:[e.BE]}]};return{aliases:["sh","zsh"],l:/\b-?[a-z\._]+\b/,k:{keyword:"if then else elif fi for while in do done case esac function",literal:"true false",built_in:"break cd continue eval exec exit export getopts hash pwd readonly return shift test times trap umask unset alias bind builtin caller command declare echo enable help let local logout mapfile printf read readarray source type typeset ulimit unalias set shopt autoload bg bindkey bye cap chdir clone comparguments compcall compctl compdescribe compfiles compgroups compquote comptags comptry compvalues dirs disable disown echotc echoti emulate fc fg float functions getcap getln history integer jobs kill limit log noglob popd print pushd pushln rehash sched setcap setopt stat suspend ttyctl unfunction unhash unlimit unsetopt vared wait whence where which zcompile zformat zftp zle zmodload zparseopts zprof zpty zregexparse zsocket zstyle ztcp",_:"-ne -eq -lt -gt -f -d -e -s -l -a"},c:[{cN:"meta",b:/^#![^\n]+sh\s*$/,r:10},{cN:"function",b:/\w[\w\d_]*\s*\(\s*\)\s*\{/,rB:!0,c:[e.inherit(e.TM,{b:/\w[\w\d_]*/})],r:0},e.HCM,r,{cN:"string",b:/'/,e:/'/},t]}}),hljs.registerLanguage("xml",function(e){var t={eW:!0,i:/</,r:0,c:[{cN:"attr",b:"[A-Za-z0-9\\._:-]+",r:0},{b:/=\s*/,r:0,c:[{cN:"string",endsParent:!0,v:[{b:/"/,e:/"/},{b:/'/,e:/'/},{b:/[^\s"'=<>`]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist"],cI:!0,c:[{cN:"meta",b:"<!DOCTYPE",e:">",r:10,c:[{b:"\\[",e:"\\]"}]},e.C("\x3c!--","--\x3e",{r:10}),{b:"<\\!\\[CDATA\\[",e:"\\]\\]>",r:10},{b:/<\?(php)?/,e:/\?>/,sL:"php",c:[{b:"/\\*",e:"\\*/",skip:!0}]},{cN:"tag",b:"<style(?=\\s|>|$)",e:">",k:{name:"style"},c:[t],starts:{e:"</style>",rE:!0,sL:["css","xml"]}},{cN:"tag",b:"<script(?=\\s|>|$)",e:">",k:{name:"script"},c:[t],starts:{e:"<\/script>",rE:!0,sL:["actionscript","javascript","handlebars","xml"]}},{cN:"meta",v:[{b:/<\?xml/,e:/\?>/,r:10},{b:/<\?\w+/,e:/\?>/}]},{cN:"tag",b:"</?",e:"/?>",c:[{cN:"name",b:/[^\/><\s]+/,r:0},t]}]}}),hljs.registerLanguage("json",function(e){var t={literal:"true false null"},r=[e.QSM,e.CNM],n={e:",",eW:!0,eE:!0,c:r,k:t},a={b:"{",e:"}",c:[{cN:"attr",b:/"/,e:/"/,c:[e.BE],i:"\\n"},e.inherit(n,{b:/:/})],i:"\\S"},c={b:"\\[",e:"\\]",c:[e.inherit(n)],i:"\\S"};return r.splice(r.length,0,a,c),{c:r,k:t,i:"\\S"}}),hljs.registerLanguage("javascript",function(e){var t="[A-Za-z$_][0-9A-Za-z$_]*",r={keyword:"in of if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const export super debugger as async await static import from as",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document Symbol Set Map WeakSet WeakMap Proxy Reflect Promise"},n={cN:"number",v:[{b:"\\b(0[bB][01]+)"},{b:"\\b(0[oO][0-7]+)"},{b:e.CNR}],r:0},a={cN:"subst",b:"\\$\\{",e:"\\}",k:r,c:[]},c={cN:"string",b:"`",e:"`",c:[e.BE,a]};a.c=[e.ASM,e.QSM,c,n,e.RM];var i=a.c.concat([e.CBCM,e.CLCM]);return{aliases:["js","jsx"],k:r,c:[{cN:"meta",r:10,b:/^\s*['"]use (strict|asm)['"]/},{cN:"meta",b:/^#!/,e:/$/},e.ASM,e.QSM,c,e.CLCM,e.CBCM,n,{b:/[{,]\s*/,r:0,c:[{b:t+"\\s*:",rB:!0,r:0,c:[{cN:"attr",b:t,r:0}]}]},{b:"("+e.RSR+"|\\b(case|return|throw)\\b)\\s*",k:"return throw case",c:[e.CLCM,e.CBCM,e.RM,{cN:"function",b:"(\\(.*?\\)|"+t+")\\s*=>",rB:!0,e:"\\s*=>",c:[{cN:"params",v:[{b:t},{b:/\(\s*\)/},{b:/\(/,e:/\)/,eB:!0,eE:!0,k:r,c:i}]}]},{b:/</,e:/(\/\w+|\w+\/)>/,sL:"xml",c:[{b:/<\w+\s*\/>/,skip:!0},{b:/<\w+/,e:/(\/\w+|\w+\/)>/,skip:!0,c:[{b:/<\w+\s*\/>/,skip:!0},"self"]}]}],r:0},{cN:"function",bK:"function",e:/\{/,eE:!0,c:[e.inherit(e.TM,{b:t}),{cN:"params",b:/\(/,e:/\)/,eB:!0,eE:!0,c:i}],i:/\[|%/},{b:/\$[(.]/},e.METHOD_GUARD,{cN:"class",bK:"class",e:/[{;=]/,eE:!0,i:/[:"\[\]]/,c:[{bK:"extends"},e.UTM]},{bK:"constructor",e:/\{/,eE:!0}],i:/#(?!!)/}});
</script>
<script>
  window.addEventListener('load', () => {
    hljs.initHighlighting();
  });
</script> <script>
  /*! lazysizes - v4.0.3 */
  !function(a,b){var c=b(a,a.document);a.lazySizes=c,"object"==typeof module&&module.exports&&(module.exports=c)}(window,function(a,b){"use strict";if(b.getElementsByClassName){var c,d,e=b.documentElement,f=a.Date,g=a.HTMLPictureElement,h="addEventListener",i="getAttribute",j=a[h],k=a.setTimeout,l=a.requestAnimationFrame||k,m=a.requestIdleCallback,n=/^picture$/i,o=["load","error","lazyincluded","_lazyloaded"],p={},q=Array.prototype.forEach,r=function(a,b){return p[b]||(p[b]=new RegExp("(\\s|^)"+b+"(\\s|$)")),p[b].test(a[i]("class")||"")&&p[b]},s=function(a,b){r(a,b)||a.setAttribute("class",(a[i]("class")||"").trim()+" "+b)},t=function(a,b){var c;(c=r(a,b))&&a.setAttribute("class",(a[i]("class")||"").replace(c," "))},u=function(a,b,c){var d=c?h:"removeEventListener";c&&u(a,b),o.forEach(function(c){a[d](c,b)})},v=function(a,d,e,f,g){var h=b.createEvent("CustomEvent");return e||(e={}),e.instance=c,h.initCustomEvent(d,!f,!g,e),a.dispatchEvent(h),h},w=function(b,c){var e;!g&&(e=a.picturefill||d.pf)?e({reevaluate:!0,elements:[b]}):c&&c.src&&(b.src=c.src)},x=function(a,b){return(getComputedStyle(a,null)||{})[b]},y=function(a,b,c){for(c=c||a.offsetWidth;c<d.minSize&&b&&!a._lazysizesWidth;)c=b.offsetWidth,b=b.parentNode;return c},z=function(){var a,c,d=[],e=[],f=d,g=function(){var b=f;for(f=d.length?e:d,a=!0,c=!1;b.length;)b.shift()();a=!1},h=function(d,e){a&&!e?d.apply(this,arguments):(f.push(d),c||(c=!0,(b.hidden?k:l)(g)))};return h._lsFlush=g,h}(),A=function(a,b){return b?function(){z(a)}:function(){var b=this,c=arguments;z(function(){a.apply(b,c)})}},B=function(a){var b,c=0,e=d.throttleDelay,g=d.ricTimeout,h=function(){b=!1,c=f.now(),a()},i=m&&g>49?function(){m(h,{timeout:g}),g!==d.ricTimeout&&(g=d.ricTimeout)}:A(function(){k(h)},!0);return function(a){var d;(a=a===!0)&&(g=33),b||(b=!0,d=e-(f.now()-c),0>d&&(d=0),a||9>d?i():k(i,d))}},C=function(a){var b,c,d=99,e=function(){b=null,a()},g=function(){var a=f.now()-c;d>a?k(g,d-a):(m||e)(e)};return function(){c=f.now(),b||(b=k(g,d))}};!function(){var b,c={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};d=a.lazySizesConfig||a.lazysizesConfig||{};for(b in c)b in d||(d[b]=c[b]);a.lazySizesConfig=d,k(function(){d.init&&F()})}();var D=function(){var g,l,m,o,p,y,D,F,G,H,I,J,K,L,M=/^img$/i,N=/^iframe$/i,O="onscroll"in a&&!/glebot/.test(navigator.userAgent),P=0,Q=0,R=0,S=-1,T=function(a){R--,a&&a.target&&u(a.target,T),(!a||0>R||!a.target)&&(R=0)},U=function(a,c){var d,f=a,g="hidden"==x(b.body,"visibility")||"hidden"!=x(a,"visibility");for(F-=c,I+=c,G-=c,H+=c;g&&(f=f.offsetParent)&&f!=b.body&&f!=e;)g=(x(f,"opacity")||1)>0,g&&"visible"!=x(f,"overflow")&&(d=f.getBoundingClientRect(),g=H>d.left&&G<d.right&&I>d.top-1&&F<d.bottom+1);return g},V=function(){var a,f,h,j,k,m,n,p,q,r=c.elements;if((o=d.loadMode)&&8>R&&(a=r.length)){f=0,S++,null==K&&("expand"in d||(d.expand=e.clientHeight>500&&e.clientWidth>500?500:370),J=d.expand,K=J*d.expFactor),K>Q&&1>R&&S>2&&o>2&&!b.hidden?(Q=K,S=0):Q=o>1&&S>1&&6>R?J:P;for(;a>f;f++)if(r[f]&&!r[f]._lazyRace)if(O)if((p=r[f][i]("data-expand"))&&(m=1*p)||(m=Q),q!==m&&(y=innerWidth+m*L,D=innerHeight+m,n=-1*m,q=m),h=r[f].getBoundingClientRect(),(I=h.bottom)>=n&&(F=h.top)<=D&&(H=h.right)>=n*L&&(G=h.left)<=y&&(I||H||G||F)&&(d.loadHidden||"hidden"!=x(r[f],"visibility"))&&(l&&3>R&&!p&&(3>o||4>S)||U(r[f],m))){if(ba(r[f]),k=!0,R>9)break}else!k&&l&&!j&&4>R&&4>S&&o>2&&(g[0]||d.preloadAfterLoad)&&(g[0]||!p&&(I||H||G||F||"auto"!=r[f][i](d.sizesAttr)))&&(j=g[0]||r[f]);else ba(r[f]);j&&!k&&ba(j)}},W=B(V),X=function(a){s(a.target,d.loadedClass),t(a.target,d.loadingClass),u(a.target,Z),v(a.target,"lazyloaded")},Y=A(X),Z=function(a){Y({target:a.target})},$=function(a,b){try{a.contentWindow.location.replace(b)}catch(c){a.src=b}},_=function(a){var b,c=a[i](d.srcsetAttr);(b=d.customMedia[a[i]("data-media")||a[i]("media")])&&a.setAttribute("media",b),c&&a.setAttribute("srcset",c)},aa=A(function(a,b,c,e,f){var g,h,j,l,o,p;(o=v(a,"lazybeforeunveil",b)).defaultPrevented||(e&&(c?s(a,d.autosizesClass):a.setAttribute("sizes",e)),h=a[i](d.srcsetAttr),g=a[i](d.srcAttr),f&&(j=a.parentNode,l=j&&n.test(j.nodeName||"")),p=b.firesLoad||"src"in a&&(h||g||l),o={target:a},p&&(u(a,T,!0),clearTimeout(m),m=k(T,2500),s(a,d.loadingClass),u(a,Z,!0)),l&&q.call(j.getElementsByTagName("source"),_),h?a.setAttribute("srcset",h):g&&!l&&(N.test(a.nodeName)?$(a,g):a.src=g),f&&(h||l)&&w(a,{src:g})),a._lazyRace&&delete a._lazyRace,t(a,d.lazyClass),z(function(){(!p||a.complete&&a.naturalWidth>1)&&(p?T(o):R--,X(o))},!0)}),ba=function(a){var b,c=M.test(a.nodeName),e=c&&(a[i](d.sizesAttr)||a[i]("sizes")),f="auto"==e;(!f&&l||!c||!a[i]("src")&&!a.srcset||a.complete||r(a,d.errorClass)||!r(a,d.lazyClass))&&(b=v(a,"lazyunveilread").detail,f&&E.updateElem(a,!0,a.offsetWidth),a._lazyRace=!0,R++,aa(a,b,f,e,c))},ca=function(){if(!l){if(f.now()-p<999)return void k(ca,999);var a=C(function(){d.loadMode=3,W()});l=!0,d.loadMode=3,W(),j("scroll",function(){3==d.loadMode&&(d.loadMode=2),a()},!0)}};return{_:function(){p=f.now(),c.elements=b.getElementsByClassName(d.lazyClass),g=b.getElementsByClassName(d.lazyClass+" "+d.preloadClass),L=d.hFac,j("scroll",W,!0),j("resize",W,!0),a.MutationObserver?new MutationObserver(W).observe(e,{childList:!0,subtree:!0,attributes:!0}):(e[h]("DOMNodeInserted",W,!0),e[h]("DOMAttrModified",W,!0),setInterval(W,999)),j("hashchange",W,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(a){b[h](a,W,!0)}),/d$|^c/.test(b.readyState)?ca():(j("load",ca),b[h]("DOMContentLoaded",W),k(ca,2e4)),c.elements.length?(V(),z._lsFlush()):W()},checkElems:W,unveil:ba}}(),E=function(){var a,c=A(function(a,b,c,d){var e,f,g;if(a._lazysizesWidth=d,d+="px",a.setAttribute("sizes",d),n.test(b.nodeName||""))for(e=b.getElementsByTagName("source"),f=0,g=e.length;g>f;f++)e[f].setAttribute("sizes",d);c.detail.dataAttr||w(a,c.detail)}),e=function(a,b,d){var e,f=a.parentNode;f&&(d=y(a,f,d),e=v(a,"lazybeforesizes",{width:d,dataAttr:!!b}),e.defaultPrevented||(d=e.detail.width,d&&d!==a._lazysizesWidth&&c(a,f,e,d)))},f=function(){var b,c=a.length;if(c)for(b=0;c>b;b++)e(a[b])},g=C(f);return{_:function(){a=b.getElementsByClassName(d.autosizesClass),j("resize",g)},checkElems:g,updateElem:e}}(),F=function(){F.i||(F.i=!0,E._(),D._())};return c={cfg:d,autoSizer:E,loader:D,init:F,uP:w,aC:s,rC:t,hC:r,fire:v,gW:y,rAF:z}}});
</script>
 <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/service-worker.js').then(registration => {
        console.log('service worker registration was successful')
      }, err => {
        console.log('service worker registration failed')
      });
    });
  }
</script>
  
    <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-66348622-2', 'auto');
  ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
  
</body>

</html>